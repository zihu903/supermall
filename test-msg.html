<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>原生测试---14-50</title>
</head>
<body>
    <h2>原生 Web-View 测试</h2>
    <p>尝试用原生方式发送...</p>

    <script>
    // 1. 检查 wx 对象是否存在
    console.log('window.wx:', window.wx);

    // 2. 检查 miniProgram 对象
    console.log('wx.miniProgram:', wx.miniProgram);

    // 3. 检查 postMessage 方法是否是函数
    console.log('typeof postMessage:', typeof wx.miniProgram.postMessage);

    // 4. 检查是否是“假”的函数（有时 UniApp 会注入一个空壳）
    if (wx.miniProgram.postMessage) {
        console.log('postMessage.toString():', wx.miniProgram.postMessage.toString());
    }

    // 5. 只有在确认是函数的情况下才执行
    if (typeof wx.miniProgram.postMessage === 'function') {
        try {
            wx.miniProgram.postMessage({ data: { action: 'test' } });
            console.log('【成功】消息已发出');
        } catch (e) {
            console.error('【异常】发送失败:', e);
        }
    } else {
        alert('postMessage 不是函数！请检查控制台');
    }
</script>
</body>
</html>
